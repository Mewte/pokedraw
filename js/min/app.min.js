function changeColor(){var o=$("#red").val(),e=$("#green").val(),n=$("#blue").val();$("#newColor").css("background-color","rgb("+o+","+e+","+n+")")}var color=$(".selected").css("background-color"),context=$("canvas")[0].getContext("2d");$(".controls").on("click","li",function(){$(this).siblings().removeClass("selected"),$(this).addClass("selected"),color=$(this).css("background-color")}),$("input[type=range]").change(changeColor),$("#addNewColor").click(function(){var o=$("<li></li>");o.css("background-color",$("#newColor").css("background-color")),$(".controls ul").append(o),o.click()});var $canvas=$("canvas"),lastEvent,mouseDown=!1;$canvas.mousedown(function(o){lastEvent=o,mouseDown=!0}).mousemove(function(o){mouseDown&&(context.beginPath(),context.moveTo(lastEvent.offsetX,lastEvent.offsetY),context.lineTo(o.offsetX,o.offsetY),context.strokeStyle=color,context.lineWidth=4,context.lineJoin="round",context.stroke(),lastEvent=o)}).mouseup(function(){mouseDown=!1}).mouseleave(function(){$canvas.mouseup()});